@{
    ViewData["Title"] = "AGROCONNECT - GestiÃ³n de Recetas Fitosanitarias";
    var isAdmin = User.IsInRole("Admin");
    var isAplicador = User.IsInRole("Aplicador");
    var isAuthenticated = User?.Identity?.IsAuthenticated ?? false;
    var userName = Context.Request.Cookies["agro_user_name"] ?? "Usuario";
}

@* ======================================================
   ADMIN DASHBOARD
   ====================================================== *@
@if (isAdmin)
{
    <div class="hero-section hero-admin">
        <div class="hero-content">
            <div class="logo-container">
                <span class="logo-icon">âš™ï¸</span>
                <h1 class="logo-text">Panel de AdministraciÃ³n</h1>
            </div>
            <p class="hero-subtitle">Bienvenido, @userName</p>
            <p class="hero-description">
                GestionÃ¡ usuarios, recetas y configuraciones del sistema desde un solo lugar.
            </p>
        </div>
    </div>

    <div class="features-section">
        <div class="container">
            <h2 class="section-title">Herramientas de AdministraciÃ³n</h2>

            <div class="features-grid">
                <div class="feature-card admin-card">
                    <div class="feature-icon">ğŸ“‹</div>
                    <h3>Recetas</h3>
                    <p>VisualizÃ¡ y gestionÃ¡ todas las recetas fitosanitarias del sistema. FiltrÃ¡ por estado, solicitante, asesor o fecha.</p>
                    <a asp-controller="Recipes" asp-action="Index" class="feature-btn">
                        Ver Recetas <span>â†’</span>
                    </a>
                </div>

                <div class="feature-card admin-card">
                    <div class="feature-icon">ğŸ‘¥</div>
                    <h3>Usuarios</h3>
                    <p>CreÃ¡ nuevos usuarios, asignales roles, bloqueÃ¡ o desbloqueÃ¡ cuentas. Control total del acceso al sistema.</p>
                    <a asp-controller="Admin" asp-action="Users" class="feature-btn">
                        Gestionar Usuarios <span>â†’</span>
                    </a>
                </div>

                <div class="feature-card admin-card">
                    <div class="feature-icon">ğŸ“Š</div>
                    <h3>Insights</h3>
                    <p>EstadÃ­sticas de recetas, productos mÃ¡s usados, tipos de aplicaciÃ³n y actividad del sistema.</p>
                    <a asp-controller="Admin" asp-action="Insights" class="feature-btn">
                        Ver Insights <span>â†’</span>
                    </a>
                </div>

                <div class="feature-card admin-card">
                    <div class="feature-icon">ğŸ“š</div>
                    <h3>API Docs</h3>
                    <p>DocumentaciÃ³n interactiva de la API REST. ProbÃ¡ endpoints directamente desde Swagger.</p>
                    <a href="/swagger" class="feature-btn" target="_blank">
                        Ver API <span>â†’</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
}
@* ======================================================
   APLICADOR HOME
   ====================================================== *@
else if (isAplicador)
{
    <div class="hero-section">
        <div class="hero-content">
            <div class="logo-container">
                <span class="logo-icon">ğŸŒ¾</span>
                <h1 class="logo-text">AGROCONNECT</h1>
            </div>
            <p class="hero-subtitle">Bienvenido, @userName</p>
            <p class="hero-description">
                GestionÃ¡ tus recetas fitosanitarias de forma digital, rÃ¡pida y segura.
            </p>
        </div>
    </div>

    <div class="features-section">
        <div class="container">
            <h2 class="section-title">Â¿QuÃ© querÃ©s hacer?</h2>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“¤</div>
                    <h3>Subir Receta</h3>
                    <p>CargÃ¡ un PDF de receta fitosanitaria. El sistema extrae automÃ¡ticamente toda la informaciÃ³n: productos, lotes, condiciones y mÃ¡s.</p>
                    <a asp-controller="RecipeView" asp-action="Upload" class="feature-btn">
                        Subir Receta <span>â†’</span>
                    </a>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">ğŸ”</div>
                    <h3>Mis Recetas</h3>
                    <p>ConsultÃ¡ el historial de recetas que cargaste. BuscÃ¡ por nÃºmero RFD, fecha, solicitante o cualquier criterio.</p>
                    <a asp-controller="RecipeView" asp-action="Index" class="feature-btn">
                        Ver Mis Recetas <span>â†’</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
}
@* ======================================================
   LANDING PÃšBLICA (no autenticado)
   ====================================================== *@
else
{
    <div class="hero-section">
        <div class="hero-content">
            <div class="logo-container">
                <span class="logo-icon">ğŸŒ¾</span>
                <h1 class="logo-text">AGROCONNECT</h1>
            </div>
            <p class="hero-subtitle">Sistema de GestiÃ³n de Recetas Fitosanitarias</p>
            <p class="hero-description">
                Plataforma integral para la carga, gestiÃ³n y aprobaciÃ³n de recetas fitosanitarias.
                Conectando agricultores, asesores y municipios en un solo lugar.
            </p>
        </div>
    </div>

    <div class="features-section">
        <div class="container">
            <h2 class="section-title">Â¿QuÃ© puedes hacer en AGROCONNECT?</h2>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“¤</div>
                    <h3>Subir Recetas</h3>
                    <p>Carga archivos PDF de recetas fitosanitarias de forma rÃ¡pida y segura. El sistema procesa automÃ¡ticamente toda la informaciÃ³n.</p>
                    <a asp-controller="Account" asp-action="Login" class="feature-btn">
                        Comenzar <span>â†’</span>
                    </a>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">ğŸ”</div>
                    <h3>Consultar Recetas</h3>
                    <p>Accede al historial completo de recetas cargadas. Busca por nÃºmero RFD, fecha, solicitante o cualquier otro criterio.</p>
                    <a asp-controller="Account" asp-action="Login" class="feature-btn">
                        Comenzar <span>â†’</span>
                    </a>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">âœ…</div>
                    <h3>Aprobar Aplicaciones</h3>
                    <p>Los municipios pueden revisar y aprobar las solicitudes de aplicaciÃ³n de productos fitosanitarios en sus jurisdicciones.</p>
                    <a asp-controller="Account" asp-action="Login" class="feature-btn">
                        Comenzar <span>â†’</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="info-section">
        <div class="container">
            <div class="info-grid">
                <div class="info-card">
                    <div class="info-number">ğŸŒ±</div>
                    <h3>Para Agricultores</h3>
                    <p>Gestiona tus recetas fitosanitarias digitalmente. Carga PDFs y accede a toda la informaciÃ³n procesada automÃ¡ticamente.</p>
                </div>

                <div class="info-card">
                    <div class="info-number">ğŸ‘¨â€ğŸ”¬</div>
                    <h3>Para Asesores</h3>
                    <p>Realiza el seguimiento de las recetas emitidas. Sistema integrado con el registro de asesores fitosanitarios.</p>
                </div>

                <div class="info-card">
                    <div class="info-number">ğŸ›ï¸</div>
                    <h3>Para Municipios</h3>
                    <p>Controla las aplicaciones en tu jurisdicciÃ³n. Revisa puntos sensibles, lotes y condiciones de aplicaciÃ³n en tiempo real.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="cta-section">
        <div class="cta-content">
            <h2>Â¿Listo para comenzar?</h2>
            <p>Digitaliza tu gestiÃ³n de recetas fitosanitarias hoy mismo</p>
            <div class="cta-buttons">
                <a asp-controller="Account" asp-action="Register" class="btn-primary-large">
                    ğŸ“ Crear Cuenta
                </a>
                <a asp-controller="Account" asp-action="Login" class="btn-secondary-large">
                    ğŸ” Iniciar SesiÃ³n
                </a>
            </div>
        </div>
    </div>
}

@section Styles {
    <link rel="stylesheet" href="~/css/home.css" asp-append-version="true">
    <link rel="stylesheet" href="~/css/admin.css" asp-append-version="true">
}
