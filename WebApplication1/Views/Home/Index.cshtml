@{
    ViewData["Title"] = "AGROCONNECT - Gesti√≥n de Recetas Fitosanitarias";
    var isAdmin = User.IsInRole("Admin");
    var isAplicador = User.IsInRole("Aplicador");
    var isAuthenticated = User?.Identity?.IsAuthenticated ?? false;
    var userName = Context.Request.Cookies["agro_user_name"] ?? "Usuario";
}

@* ======================================================
   ADMIN DASHBOARD
   ====================================================== *@
@if (isAdmin)
{
    <div class="hero-section hero-admin">
        <div class="hero-content">
            <div class="logo-container">
                <span class="logo-icon">‚öôÔ∏è</span>
                <h1 class="logo-text">Panel de Administraci√≥n</h1>
            </div>
            <p class="hero-subtitle">Bienvenido, @userName</p>
            <p class="hero-description">
                Gestion√° usuarios, recetas y configuraciones del sistema desde un solo lugar.
            </p>
        </div>
    </div>

    <div class="features-section">
        <div class="container">
            <h2 class="section-title">Herramientas de Administraci√≥n</h2>

            <div class="features-grid">
                <div class="feature-card admin-card">
                    <div class="feature-icon">üìã</div>
                    <h3>Recetas</h3>
                    <p>Visualiz√° y gestion√° todas las recetas fitosanitarias del sistema. Filtr√° por estado, solicitante, asesor o fecha.</p>
                    <a asp-controller="Recipes" asp-action="Index" class="feature-btn">
                        Ver Recetas <span>‚Üí</span>
                    </a>
                </div>

                <div class="feature-card admin-card">
                    <div class="feature-icon">üë•</div>
                    <h3>Usuarios</h3>
                    <p>Cre√° nuevos usuarios, asignales roles, bloque√° o desbloque√° cuentas. Control total del acceso al sistema.</p>
                    <a asp-controller="Admin" asp-action="Users" class="feature-btn">
                        Gestionar Usuarios <span>‚Üí</span>
                    </a>
                </div>

                <div class="feature-card admin-card">
                    <div class="feature-icon">üìä</div>
                    <h3>Insights</h3>
                    <p>Estad√≠sticas de recetas, productos m√°s usados, tipos de aplicaci√≥n y actividad del sistema.</p>
                    <span class="feature-btn feature-btn-disabled">
                        Pr√≥ximamente
                    </span>
                </div>

                <div class="feature-card admin-card">
                    <div class="feature-icon">üìö</div>
                    <h3>API Docs</h3>
                    <p>Documentaci√≥n interactiva de la API REST. Prob√° endpoints directamente desde Swagger.</p>
                    <a href="/swagger" class="feature-btn" target="_blank">
                        Ver API <span>‚Üí</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
}
@* ======================================================
   APLICADOR HOME
   ====================================================== *@
else if (isAplicador)
{
    <div class="hero-section">
        <div class="hero-content">
            <div class="logo-container">
                <span class="logo-icon">üåæ</span>
                <h1 class="logo-text">AGROCONNECT</h1>
            </div>
            <p class="hero-subtitle">Bienvenido, @userName</p>
            <p class="hero-description">
                Gestion√° tus recetas fitosanitarias de forma digital, r√°pida y segura.
            </p>
        </div>
    </div>

    <div class="features-section">
        <div class="container">
            <h2 class="section-title">¬øQu√© quer√©s hacer?</h2>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üì§</div>
                    <h3>Subir Receta</h3>
                    <p>Carg√° un PDF de receta fitosanitaria. El sistema extrae autom√°ticamente toda la informaci√≥n: productos, lotes, condiciones y m√°s.</p>
                    <a asp-controller="RecipeView" asp-action="Upload" class="feature-btn">
                        Subir Receta <span>‚Üí</span>
                    </a>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">üîç</div>
                    <h3>Mis Recetas</h3>
                    <p>Consult√° el historial de recetas que cargaste. Busc√° por n√∫mero RFD, fecha, solicitante o cualquier criterio.</p>
                    <a asp-controller="RecipeView" asp-action="Index" class="feature-btn">
                        Ver Mis Recetas <span>‚Üí</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
}
@* ======================================================
   LANDING P√öBLICA (no autenticado)
   ====================================================== *@
else
{
    <div class="hero-section">
        <div class="hero-content">
            <div class="logo-container">
                <span class="logo-icon">üåæ</span>
                <h1 class="logo-text">AGROCONNECT</h1>
            </div>
            <p class="hero-subtitle">Sistema de Gesti√≥n de Recetas Fitosanitarias</p>
            <p class="hero-description">
                Plataforma integral para la carga, gesti√≥n y aprobaci√≥n de recetas fitosanitarias.
                Conectando agricultores, asesores y municipios en un solo lugar.
            </p>
        </div>
    </div>

    <div class="features-section">
        <div class="container">
            <h2 class="section-title">¬øQu√© puedes hacer en AGROCONNECT?</h2>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üì§</div>
                    <h3>Subir Recetas</h3>
                    <p>Carga archivos PDF de recetas fitosanitarias de forma r√°pida y segura. El sistema procesa autom√°ticamente toda la informaci√≥n.</p>
                    <a asp-controller="Account" asp-action="Login" class="feature-btn">
                        Comenzar <span>‚Üí</span>
                    </a>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">üîç</div>
                    <h3>Consultar Recetas</h3>
                    <p>Accede al historial completo de recetas cargadas. Busca por n√∫mero RFD, fecha, solicitante o cualquier otro criterio.</p>
                    <a asp-controller="Account" asp-action="Login" class="feature-btn">
                        Comenzar <span>‚Üí</span>
                    </a>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">‚úÖ</div>
                    <h3>Aprobar Aplicaciones</h3>
                    <p>Los municipios pueden revisar y aprobar las solicitudes de aplicaci√≥n de productos fitosanitarios en sus jurisdicciones.</p>
                    <a asp-controller="Account" asp-action="Login" class="feature-btn">
                        Comenzar <span>‚Üí</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="info-section">
        <div class="container">
            <div class="info-grid">
                <div class="info-card">
                    <div class="info-number">üå±</div>
                    <h3>Para Agricultores</h3>
                    <p>Gestiona tus recetas fitosanitarias digitalmente. Carga PDFs y accede a toda la informaci√≥n procesada autom√°ticamente.</p>
                </div>

                <div class="info-card">
                    <div class="info-number">üë®‚Äçüî¨</div>
                    <h3>Para Asesores</h3>
                    <p>Realiza el seguimiento de las recetas emitidas. Sistema integrado con el registro de asesores fitosanitarios.</p>
                </div>

                <div class="info-card">
                    <div class="info-number">üèõÔ∏è</div>
                    <h3>Para Municipios</h3>
                    <p>Controla las aplicaciones en tu jurisdicci√≥n. Revisa puntos sensibles, lotes y condiciones de aplicaci√≥n en tiempo real.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="cta-section">
        <div class="cta-content">
            <h2>¬øListo para comenzar?</h2>
            <p>Digitaliza tu gesti√≥n de recetas fitosanitarias hoy mismo</p>
            <div class="cta-buttons">
                <a asp-controller="Account" asp-action="Register" class="btn-primary-large">
                    üìù Crear Cuenta
                </a>
                <a asp-controller="Account" asp-action="Login" class="btn-secondary-large">
                    üîê Iniciar Sesi√≥n
                </a>
            </div>
        </div>
    </div>
}

@section Styles {
    <link rel="stylesheet" href="~/css/home.css" asp-append-version="true">
    <link rel="stylesheet" href="~/css/admin.css" asp-append-version="true">
}
